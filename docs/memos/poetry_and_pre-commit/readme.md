# Памятка по работе с Poetry и Pre-commit

## Poetry
Poetry - это инстурмент для управления зависимостями и виртуальным окружением. Подробное описание и документацию можно посмотреть на https://python-poetry.org/<br>
Основаная конфигурация poetry находится в файле `pyproject.toml`.<br>
В `poetry.lock` находится информация об установленных зависимостях (этот файл генерируется автоматически). Его назначение - зафиксировать версии зависимостей, которые в данный момент используются в проекте.<br>

### Порядок работы с Poetry
1. Установить, следуя инструкции https://python-poetry.org/docs/#installation
2. Сконфигурировать для создания виртуального окружения в папке проекта (этот пункт опционален, по умолчанию поэтри создаёт виртуальное окружение в cache-директории)
```sh
poetry config virtualenvs.in-project true
```
3. В репо поэтри уже проинициализирован, поэтому можно сразу создать вирутальное окружение и установить зависимости
```sh
poetry install
poetry shell
```

#### Основные команды

Добавить пакет
```sh
poetry add <имя пакета>
```
Если добавляется пакет, который не будет использоваться на сервере (например, flake8), то лучше отнести её в группу `dev`
```sh
poetry add <имя пакета> --group dev
```
Удалить пакет
```sh
poetry remove <имя пакета>
```

## Pre-commit
Pre-commit - инстурмент, который позволяет запускать различные действия (хуки) перед выполнением коммита изменений в git. Хуки перечислены в файле `.pre-commit-config.yaml`.

### Установка pre-commit
1. Установить зависимости проекта
```sh
poetry install
```
2. Установить pre-commit
```sh
pre-commit install
```

### Использование pre-commit
Pre-commit работает автоматически: перед каждым коммитом сработают хуки и будут запущены линтер и форматтер, который автоматически отформатирует код (либо в консоль будут выведены пути к файлам, которые необходимо исправить самостоятельно и недочеты, которые нужно исправить в этих файлах).<br><br>
Пока все замечания, выявленные pre-commit не будут устранены, коммит не будет осуществлен.
> **Note**:
> Обратите внимание, что файлы, которые были отформатированы pre-commit'ом, нужно снова добавить в staged, т.е. выполнить команду `git add <имя файла>`
